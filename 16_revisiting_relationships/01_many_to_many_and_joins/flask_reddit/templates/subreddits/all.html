{% extends "home.html" %}

{% block left %}
<div class="subreddits-list">
    <h2>All Subreddits</h2>

    {% for subreddit in subreddits %}
    <div class="subreddit-item" style="border-bottom: 1px solid #ddd; padding: 15px 0;">
        <h3>
            <a href="{{ url_for('subreddits.permalink', subreddit_name=subreddit.name) }}">
                r/{{ subreddit.name }}
            </a>
        </h3>

        <p>{{ subreddit.desc }}</p>

        <p class="text-muted">
            {{ subreddit.get_subscriber_count() }} subscribers
        </p>

        {% if user %}
            {% if user.is_subscribed(subreddit) %}
                <form action="{{ url_for('subreddits.unsubscribe', subreddit_name=subreddit.name) }}" method="POST" style="display: inline;">
                    <button type="submit" class="btn btn-default btn-sm">Unsubscribe</button>
                </form>
            {% else %}
                <form action="{{ url_for('subreddits.subscribe', subreddit_name=subreddit.name) }}" method="POST" style="display: inline;">
                    <button type="submit" class="btn btn-primary btn-sm">Subscribe</button>
                </form>
            {% endif %}
        {% endif %}
    </div>
    {% endfor %}

    {% if subreddits|length == 0 %}
        <p class="text-muted">No subreddits yet.</p>
    {% endif %}
</div>
{% endblock %}